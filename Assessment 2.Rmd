---
title: "Assessment 2"
author: "Tolga Akturk"
date: '2022-03-20'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(tidyverse)
library(skimr)
library(randomForest)

```

```{r}

thanksgiving<-read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018/2018-11-20/thanksgiving_meals.csv")

```

### Part 1: formatting RMarkdown document  (2 marks)

### 1. Create an Rmarkdown document with webpage as output (same as in setup)

At the start of the output document include your name in italic font and 
your student id in bold font as level 2 heading 

Separate with a solid line 

Include the title “Assignment 2” as level 1 heading 

Separate with a solid line 

List all tasks in the assignment as headings of the third level and include your results (=output) below each task showing your R code. 

## *Tolga Akturk* **s3876862**

---

# Assignment 2

---

### Part 2: Data Wrangling and visualization (38 marks)

### 1. Display the first 10 rows of the dataset using `kable()` function (1 marks)

```{r}

knitr::kable(head(thanksgiving[, 1:10]))

```

### 2. Using `skim()` display the summary of variables. 

### Think about the task to predict a family income based on their menu: what variables may be useful? Are all of them correct type? Write 2-3 sentences with your explanation. (2 marks)


```{r}

skim(thanksgiving)

#The menu and by extension the menu variables are in this case the inputs and predicting family income is the output of this model. There are a few variables which I believe may be useful to answering this question, these include; main_dish, main_prep, stuffing, cranberry & gravy. The reason why I suggest these are that these variables have very few data points missing compared to the others which have 800+ missing data points. The results would not be conclusive as the data is weak. They also are not in their correct form. They are listed as "characters" which could not give us quantitative information. I would need to use as_factor to use them correctly. The code is below to do exactly this.

thanksgiving<-thanksgiving%>%
  mutate(
    family_income=as_factor(family_income),
    main_dish=as_factor(main_dish),
    main_prep=as_factor(main_prep),
    stuffing=as_factor(stuffing),
    cranberry=as_factor(cranberry),
    gravy=as_factor(gravy),
    age=as_factor(age),
    gender=as_factor(gender),
    us_region=as_factor(us_region),
    celebrate=as_factor(celebrate))


```

### Think about the task to predict a community type or US_region based on their menu: what variables may be useful? Are all of them correct type? (2 marks)

```{r}

#In this question we will need to model using the menu variables once again as my input, these include; main_dish, main_prep, stuffing, cranberry & gravy. Therefore my output would be to predict a community_type or us_region. They are all once again not correct as they are listed as characters and will be needed to changed to factors for any data visualisation to occur. 

```

### 3. Use `fct_reorder` and `parse_number` functions to create a factor variable `family_income` (2 mark)


```{r}

thanksgiving_1<-thanksgiving_1%>%
  mutate(family_income=fct_reorder(family_income, parse_number(family_income)))

skim(thanksgiving_1)

thanksgiving_1%>%
  count(family_income)


```

### 4. What is the number of people who celebrate? (1 mark)

```{r}
thanksgiving%>%
count(celebrate)

#According to the data 980 people celebrated Thanksgiving from the total of 1,058 surveys completed. That is approximately 93% of the participants.
```

### 5. What are categories and insights for each main dish served and the method it is prepared? (2 marks)

```{r}

thanksgiving%>%
  count(main_dish)

thanksgiving%>%
  count(main_dish_other)

thanksgiving%>%
  count(main_prep)

#We can see from the results from running a count check on main_dish is that 859 had Turkey as their main dish for Thanksgiving. Other main dishes that were recorded were; Tofurkey, Ham/Pork, Turducken, Roast Beef & Chicken. Additionally we can see that there were a combination of methods to prepare Thanksgiving these include; Baked & Roasted primarily contributing to 481 & 378 respectively. A small portion Fried their Thanksgiving main meals with a total of 47 people. 
  
```

### 6. Create 3 different data viz showing insights for main dish served and the method. Provide your own legend and use themes.

### Write 2-3 sentences with your explanation of each insight. (4 marks)

```{r}

##NOT DONE

thanksgiving%>%
  ggplot(aes(main_dish, colour = main_prep)) +
  geom_bar() +
  labs(x= "Thanksgiving Main Dish", y= "Number of People", title= "Most Popular Thanksgiving Meal", subtitle = "Question 6") +
  theme_classic() +
  coord_flip()
 
#This data visualisation highlights to the viewers that clearly the most popular Thanksgiving meal is Turkey and this is split almost 50/50 by roasted or baked. You can see this as the x asis highlights the number of people and on the y axis the chosen main meals which colour is added to see the meal prep of those meals. 

```

```{r}

```

```{r}

```

### 7. How many use cranberry sauce? How many use gravy? 2marks

```{r}
thanksgiving%>%
  count(cranberry)

thanksgiving%>%
  count(gravy)

#803 people surveyed used cranberry sauce and 892 people surveyed used gravy.

```

### 8 - 9 What is the distribution of those who celebrate across income ranges. Create a data viz. Write 2-3 sentences with your explanation of each insight. (4 marks)

```{r}

##NOT DONE
thanksgiving_1%>%
  ggplot(
    aes(celebrate, family_income)) +
  geom_col()
```

### 10. Use the following code to create a new data set 2 mark

`
select(id, starts_with("side"),
         starts_with("pie"),
         starts_with("dessert")) %>%
  select(-side15, -pie13, -dessert12) %>%
  gather(type, value, -id) %>%
  filter(!is.na(value),
         !value %in% c("None", "Other (please specify)")) %>%
  mutate(type = str_remove(type, "\\d+"))
`

Write 2-3 sentences with your explanation of what it does. (4 marks)

```{r}

#NOT DONE
new_dataset<-thanksgiving%>%
  select(id, starts_with("side"),
         starts_with("pie"),
         starts_with("dessert")) %>%
  select(-side15, -pie13, -dessert12) %>%
  gather(type, value, -id) %>%
  filter(!is.na(value),
         !value %in% c("None", "Other (please specify)")) %>%
  mutate(type = str_remove(type, "\\d+"))

#This new_dataset has 8145 observations of only 3 variables which is the survey ID, type and value. 

```

### 11 - 12 Intall package `widyr` and use `pairwise_cor()` function https://www.rdocumentation.org/packages/widyr/versions/0.1.3/topics/pairwise_cor 

Write 2-3 sentences with your explanation of what it does. (2 marks)

Use this code for the new dataset

`
pairwise_cor(value, id, sort = TRUE)

`
Write 1 sentence with your explanation of what insights it shows. (2 marks)

```{r}
#NOT DONE
```

### 13. Use `lm()` or randomForest() function to build a model that predict a family income based on data in the dataset. 8 marks

Compare 3 models using different set of input variables. Use different number of variables.

Explain your choice of variables (3 sentences) 

Write 2 sentences explaining which model is best.

```{r}

```


